<!DOCTYPE html><html lang="en" style="font-size:16px"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Source: threads/message.thread.js</title><!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]--><script src="scripts/third-party/hljs.js" defer="defer"></script><script src="scripts/third-party/hljs-line-num.js" defer="defer"></script><script src="scripts/third-party/popper.js" defer="defer"></script><script src="scripts/third-party/tippy.js" defer="defer"></script><script src="scripts/third-party/tocbot.min.js"></script><script>var baseURL="/",locationPathname="";baseURL=(locationPathname=document.location.pathname).substr(0,locationPathname.lastIndexOf("/")+1)</script><link rel="stylesheet" href="styles/clean-jsdoc-theme.min.css"><svg aria-hidden="true" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display:none"><defs><symbol id="copy-icon" viewbox="0 0 488.3 488.3"><g><path d="M314.25,85.4h-227c-21.3,0-38.6,17.3-38.6,38.6v325.7c0,21.3,17.3,38.6,38.6,38.6h227c21.3,0,38.6-17.3,38.6-38.6V124    C352.75,102.7,335.45,85.4,314.25,85.4z M325.75,449.6c0,6.4-5.2,11.6-11.6,11.6h-227c-6.4,0-11.6-5.2-11.6-11.6V124    c0-6.4,5.2-11.6,11.6-11.6h227c6.4,0,11.6,5.2,11.6,11.6V449.6z"/><path d="M401.05,0h-227c-21.3,0-38.6,17.3-38.6,38.6c0,7.5,6,13.5,13.5,13.5s13.5-6,13.5-13.5c0-6.4,5.2-11.6,11.6-11.6h227    c6.4,0,11.6,5.2,11.6,11.6v325.7c0,6.4-5.2,11.6-11.6,11.6c-7.5,0-13.5,6-13.5,13.5s6,13.5,13.5,13.5c21.3,0,38.6-17.3,38.6-38.6    V38.6C439.65,17.3,422.35,0,401.05,0z"/></g></symbol><symbol id="search-icon" viewBox="0 0 512 512"><g><g><path d="M225.474,0C101.151,0,0,101.151,0,225.474c0,124.33,101.151,225.474,225.474,225.474    c124.33,0,225.474-101.144,225.474-225.474C450.948,101.151,349.804,0,225.474,0z M225.474,409.323    c-101.373,0-183.848-82.475-183.848-183.848S124.101,41.626,225.474,41.626s183.848,82.475,183.848,183.848    S326.847,409.323,225.474,409.323z"/></g></g><g><g><path d="M505.902,476.472L386.574,357.144c-8.131-8.131-21.299-8.131-29.43,0c-8.131,8.124-8.131,21.306,0,29.43l119.328,119.328    c4.065,4.065,9.387,6.098,14.715,6.098c5.321,0,10.649-2.033,14.715-6.098C514.033,497.778,514.033,484.596,505.902,476.472z"/></g></g></symbol><symbol id="font-size-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M11.246 15H4.754l-2 5H.6L7 4h2l6.4 16h-2.154l-2-5zm-.8-2L8 6.885 5.554 13h4.892zM21 12.535V12h2v8h-2v-.535a4 4 0 1 1 0-6.93zM19 18a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/></symbol><symbol id="add-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M11 11V5h2v6h6v2h-6v6h-2v-6H5v-2z"/></symbol><symbol id="minus-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M5 11h14v2H5z"/></symbol><symbol id="dark-theme-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M10 7a7 7 0 0 0 12 4.9v.1c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2h.1A6.979 6.979 0 0 0 10 7zm-6 5a8 8 0 0 0 15.062 3.762A9 9 0 0 1 8.238 4.938 7.999 7.999 0 0 0 4 12z"/></symbol><symbol id="light-theme-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"/></symbol><symbol id="reset-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M18.537 19.567A9.961 9.961 0 0 1 12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10c0 2.136-.67 4.116-1.81 5.74L17 12h3a8 8 0 1 0-2.46 5.772l.997 1.795z"/></symbol><symbol id="down-icon" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.7803 6.21967C13.0732 6.51256 13.0732 6.98744 12.7803 7.28033L8.53033 11.5303C8.23744 11.8232 7.76256 11.8232 7.46967 11.5303L3.21967 7.28033C2.92678 6.98744 2.92678 6.51256 3.21967 6.21967C3.51256 5.92678 3.98744 5.92678 4.28033 6.21967L8 9.93934L11.7197 6.21967C12.0126 5.92678 12.4874 5.92678 12.7803 6.21967Z"></path></symbol><symbol id="codepen-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M16.5 13.202L13 15.535v3.596L19.197 15 16.5 13.202zM14.697 12L12 10.202 9.303 12 12 13.798 14.697 12zM20 10.869L18.303 12 20 13.131V10.87zM19.197 9L13 4.869v3.596l3.5 2.333L19.197 9zM7.5 10.798L11 8.465V4.869L4.803 9 7.5 10.798zM4.803 15L11 19.131v-3.596l-3.5-2.333L4.803 15zM4 13.131L5.697 12 4 10.869v2.262zM2 9a1 1 0 0 1 .445-.832l9-6a1 1 0 0 1 1.11 0l9 6A1 1 0 0 1 22 9v6a1 1 0 0 1-.445.832l-9 6a1 1 0 0 1-1.11 0l-9-6A1 1 0 0 1 2 15V9z"/></symbol><symbol id="close-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 10.586l4.95-4.95 1.414 1.414-4.95 4.95 4.95 4.95-1.414 1.414-4.95-4.95-4.95 4.95-1.414-1.414 4.95-4.95-4.95-4.95L7.05 5.636z"/></symbol><symbol id="menu-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z"/></symbol></defs></svg></head><body data-theme="dark"><div class="sidebar-container"><div class="sidebar" id="sidebar"><a href="/" class="sidebar-title sidebar-title-anchor">Home</a><div class="sidebar-items-container"><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-classes"><div>Classes</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="DataCaptureThread.html">DataCaptureThread</a></div><div class="sidebar-section-children"><a href="InternalStateManager.html">InternalStateManager</a></div><div class="sidebar-section-children"><a href="Logger.html">Logger</a></div><div class="sidebar-section-children"><a href="NetworkRequest.html">NetworkRequest</a></div><div class="sidebar-section-children"><a href="NetworkRequestsHandler.html">NetworkRequestsHandler</a></div><div class="sidebar-section-children"><a href="NodeManager.html">NodeManager</a></div><div class="sidebar-section-children"><a href="Pipeline.html">Pipeline</a></div><div class="sidebar-section-children"><a href="PluginInstance.html">PluginInstance</a></div><div class="sidebar-section-children"><a href="RedisStateManager.html">RedisStateManager</a></div><div class="sidebar-section-children"><a href="State.html">State</a></div><div class="sidebar-section-children"><a href="ZxAIBC.html">ZxAIBC</a></div><div class="sidebar-section-children"><a href="ZxAIClient.html">ZxAIClient</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-global"><div>Global</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="global.html#AlertedNodes">AlertedNodes</a></div><div class="sidebar-section-children"><a href="global.html#AllowedValues">AllowedValues</a></div><div class="sidebar-section-children"><a href="global.html#AvailableDCTResponse">AvailableDCTResponse</a></div><div class="sidebar-section-children"><a href="global.html#AvailableSchemaResponse">AvailableSchemaResponse</a></div><div class="sidebar-section-children"><a href="global.html#Field">Field</a></div><div class="sidebar-section-children"><a href="global.html#IntervalDefinition">IntervalDefinition</a></div><div class="sidebar-section-children"><a href="global.html#IsObject">IsObject</a></div><div class="sidebar-section-children"><a href="global.html#NodeStatus">NodeStatus</a></div><div class="sidebar-section-children"><a href="global.html#ObservedNodes">ObservedNodes</a></div><div class="sidebar-section-children"><a href="global.html#RedisConnectionOptions">RedisConnectionOptions</a></div><div class="sidebar-section-children"><a href="global.html#SchemaCollection">SchemaCollection</a></div><div class="sidebar-section-children"><a href="global.html#SchemaDefinition">SchemaDefinition</a></div><div class="sidebar-section-children"><a href="global.html#SchemasRepository">SchemasRepository</a></div><div class="sidebar-section-children"><a href="global.html#ZxAIBlockchainOptions">ZxAIBlockchainOptions</a></div><div class="sidebar-section-children"><a href="global.html#ZxAIClientEvent">ZxAIClientEvent</a></div><div class="sidebar-section-children"><a href="global.html#ZxAIClientOptions">ZxAIClientOptions</a></div><div class="sidebar-section-children"><a href="global.html#ZxAICommand">ZxAICommand</a></div><div class="sidebar-section-children"><a href="global.html#ZxAIEventType">ZxAIEventType</a></div><div class="sidebar-section-children"><a href="global.html#ZxAIUpdateInstanceConfig">ZxAIUpdateInstanceConfig</a></div><div class="sidebar-section-children"><a href="global.html#applyDefaultsToObject">applyDefaultsToObject</a></div><div class="sidebar-section-children"><a href="global.html#archiveConfigRequestStrategy">archiveConfigRequestStrategy</a></div><div class="sidebar-section-children"><a href="global.html#base64ToUrlSafeBase64">base64ToUrlSafeBase64</a></div><div class="sidebar-section-children"><a href="global.html#camelToZxAIFormat">camelToZxAIFormat</a></div><div class="sidebar-section-children"><a href="global.html#checkMandatoryFields">checkMandatoryFields</a></div><div class="sidebar-section-children"><a href="global.html#checkType">checkType</a></div><div class="sidebar-section-children"><a href="global.html#computeDifferences">computeDifferences</a></div><div class="sidebar-section-children"><a href="global.html#convertKeysToCamelFormat">convertKeysToCamelFormat</a></div><div class="sidebar-section-children"><a href="global.html#convertKeysToZxAIFormat">convertKeysToZxAIFormat</a></div><div class="sidebar-section-children"><a href="global.html#dctSchemas">dctSchemas</a></div><div class="sidebar-section-children"><a href="global.html#decode">decode</a></div><div class="sidebar-section-children"><a href="global.html#defaultSchemas">defaultSchemas</a></div><div class="sidebar-section-children"><a href="global.html#encode">encode</a></div><div class="sidebar-section-children"><a href="global.html#generateId">generateId</a></div><div class="sidebar-section-children"><a href="global.html#getRedisConnection">getRedisConnection</a></div><div class="sidebar-section-children"><a href="global.html#hasFleetFilter">hasFleetFilter</a></div><div class="sidebar-section-children"><a href="global.html#identityFormatter">identityFormatter</a></div><div class="sidebar-section-children"><a href="global.html#pick">pick</a></div><div class="sidebar-section-children"><a href="global.html#pluginDefinition">pluginDefinition</a></div><div class="sidebar-section-children"><a href="global.html#pluginSchemas">pluginSchemas</a></div><div class="sidebar-section-children"><a href="global.html#rawIn">rawIn</a></div><div class="sidebar-section-children"><a href="global.html#schema">schema</a></div><div class="sidebar-section-children"><a href="global.html#schema">schema</a></div><div class="sidebar-section-children"><a href="global.html#schema">schema</a></div><div class="sidebar-section-children"><a href="global.html#schema">schema</a></div><div class="sidebar-section-children"><a href="global.html#schema">schema</a></div><div class="sidebar-section-children"><a href="global.html#schema">schema</a></div><div class="sidebar-section-children"><a href="global.html#schemas">schemas</a></div><div class="sidebar-section-children"><a href="global.html#sleep">sleep</a></div><div class="sidebar-section-children"><a href="global.html#updateConfigRequestStrategy">updateConfigRequestStrategy</a></div><div class="sidebar-section-children"><a href="global.html#updatePipelineInstanceRequestStrategy">updatePipelineInstanceRequestStrategy</a></div><div class="sidebar-section-children"><a href="global.html#urlSafeBase64ToBase64">urlSafeBase64ToBase64</a></div><div class="sidebar-section-children"><a href="global.html#validateAgainstSchema">validateAgainstSchema</a></div><div class="sidebar-section-children"><a href="global.html#zxAIFormatToCamel">zxAIFormatToCamel</a></div></div></div></div></div><div class="navbar-container" id="VuAckcnZhf"><nav class="navbar"><div class="navbar-left-items"></div><div class="navbar-right-items"><div class="navbar-right-item"><button class="icon-button search-button" aria-label="open-search"><svg><use xlink:href="#search-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button theme-toggle" aria-label="toggle-theme"><svg><use class="theme-svg-use" xlink:href="#light-theme-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button font-size" aria-label="change-font-size"><svg><use xlink:href="#font-size-icon"></use></svg></button></div></div><nav></nav></nav></div><div class="toc-container"><div class="toc-content"><span class="bold">On this page</span><div id="eed4d2a0bfd64539bb9df78095dec881"></div></div></div><div class="body-wrapper"><div class="main-content"><div class="main-wrapper"><section id="source-page" class="source-page"><header><h1 id="title" class="has-anchor">threads_message.thread.js</h1></header><article><pre class="prettyprint source lang-js"><code>import { parentPort } from 'worker_threads';
import * as mqtt from 'mqtt';
import { concatMap, filter, fromEvent, map, tap } from 'rxjs';
import { processHeartbeat } from './heartbeat.processor.js';
import { notificationProcessor } from './notification.processor.js';
import { payloadProcessor } from './payload.processor.js';
import { rawIn } from '../formatters/raw.formatter.js';
import { identityFormatter } from '../formatters/identity.formatter.js';
import {
    ALL_EDGE_NODES,
    INTERNAL_STATE_MANAGER,
    MESSAGE_TYPE_HEARTBEAT,
    MESSAGE_TYPE_NETWORK_REQUEST_RESPONSE,
    MESSAGE_TYPE_NOTIFICATION,
    MESSAGE_TYPE_OBSERVED_NODE,
    MESSAGE_TYPE_PAYLOAD,
    MESSAGE_TYPE_SUPERVISOR_STATUS,
    REDIS_STATE_MANAGER,
    STICKY_COMMAND_ID_KEY,
    THREAD_COMMAND_IGNORE_SESSION_ID,
    THREAD_COMMAND_START,
    THREAD_COMMAND_UPDATE_FLEET,
    THREAD_COMMAND_UPDATE_STATE,
    THREAD_COMMAND_WATCH_FOR_SESSION_ID,
    THREAD_COMMAND_WATCH_FOR_STICKY_SESSION_ID,
    THREAD_TYPE_HEARTBEATS,
    THREAD_TYPE_NOTIFICATIONS,
    THREAD_TYPE_PAYLOADS,
    THREAD_TYPE_UNKNOWN,
    logLevels,
    MESSAGE_TYPE_NETWORK_ADDRESSES_REFRESH,
    THREAD_COMMAND_MEMORY_USAGE,
    MESSAGE_TYPE_THREAD_MEMORY_USAGE,
    MESSAGE_TYPE_NETWORK_NODE_DOWN,
    MESSAGE_TYPE_NETWORK_SUPERVISOR_PAYLOAD,
} from '../constants.js';
import { ZxAIBC } from '../utils/blockchain.js';
import { hasFleetFilter } from '../utils/helper.functions.js';
import EventEmitter2 from 'eventemitter2';
import { getRedisConnection } from '../utils/redis.connection.provider.js';

export const THREAD_START_OK = 'thread.start.ok';
export const THREAD_START_ERR = 'thread.start.ok';

class ThreadLogger {
    /**
     * @type {MessagePort}
     */
    mainThread;

    threadId = null;

    constructor() {
        this.mainThread = parentPort;
    }

    setThreadId(threadId) {
        this.threadId = threadId;
    }

    log(message, context) {
        this.mainThread.postMessage({
            threadId: this.threadId,
            type: 'LOGGER',
            level: logLevels.info,
            message,
            context,
        });
    }

    error(message, context) {
        this.mainThread.postMessage({
            threadId: this.threadId,
            type: 'LOGGER',
            level: logLevels.error,
            message,
            context,
        });
    }

    warn(message, context) {
        this.mainThread.postMessage({
            threadId: this.threadId,
            type: 'LOGGER',
            level: logLevels.warn,
            message,
            context,
        });
    }

    debug(message, context) {
        this.mainThread.postMessage({
            threadId: this.threadId,
            type: 'LOGGER',
            level: logLevels.debug,
            message,
            context,
        });
    }

    verbose(message, context) {
        this.mainThread.postMessage({
            threadId: this.threadId,
            type: 'LOGGER',
            level: logLevels.verbose,
            message,
            context,
        });
    }
}

const logger = new ThreadLogger();

const bootStatus = {
    mqtt: {
        connection: null,
        topic: null,
    },
    redis: {
        cache: null,
        publishChannel: null,
        subscriptionChannel: null,
        topic: null,
    },
};

const bootSeqCompleted = () => {
    return (
        bootStatus.mqtt.connection !== null &amp;&amp;
        bootStatus.mqtt.topic !== null &amp;&amp;
        bootStatus.redis.cache !== null &amp;&amp;
        bootStatus.redis.publishChannel !== null &amp;&amp;
        bootStatus.redis.subscriptionChannel !== null &amp;&amp;
        bootStatus.redis.topic !== null
    );
};

const bootedSuccessfully = () => {
    return (
        bootStatus.mqtt.connection === true &amp;&amp;
        bootStatus.mqtt.topic === true &amp;&amp;
        bootStatus.redis.cache === true &amp;&amp;
        bootStatus.redis.publishChannel === true &amp;&amp;
        bootStatus.redis.subscriptionChannel === true &amp;&amp;
        bootStatus.redis.topic === true
    );
};

const markBootUpdate = (path, status, threadId, threadType) => {
    const [module, component] = path.split('.');
    bootStatus[module][component] = status;

    let event = THREAD_START_OK;
    if (bootSeqCompleted()) {
        if (!bootedSuccessfully()) {
            event = THREAD_START_ERR;
        }

        parentPort.postMessage({
            threadId: threadId,
            threadType: threadType,
            type: event,
            status: bootStatus,
        });
    }
};

export class Thread extends EventEmitter2 {
    /**
     * The main thread connection.
     *
     * @type {MessagePort}
     */
    mainThread;

    pubSubChannel = 'unknown';

    threadId = 'none';

    /**
     * The network connection.
     *
     * @type {mqtt.MqttClient}
     */
    mqttClient = null;

    threadType = THREAD_TYPE_UNKNOWN;

    startupOptions = {
        connection: {
            topic: null,
            url: null,
            username: null,
            password: null,
            clean: true,
            clientId: null,
        },
        stateManager: INTERNAL_STATE_MANAGER,
        redis: {
            host: 'localhost',
            port: 6379,
            password: null,
            pubSubChannel: 'null',
        },
        secure: false,
        zxaibc: {
            debug: false,
            key: null,
            encrypt: true,
            secure: true,
        },
        fleet: [ALL_EDGE_NODES],
    };

    state = {};

    cache = null;

    publishChannel = null;

    subscriptionChannel = null;

    formatters = {
        raw: { in: rawIn },
        '0xai1.0': { in: identityFormatter },
    };

    /**
     * The NaeuralEdgeProtocol Blockchain Engine
     *
     * @type {ZxAIBC}
     */
    zxaibc = null;

    watchlist = {};

    stickySessions = {};

    logger;

    /**
     * Flag for signaling if messages should be encrypted.
     *
     * @type {boolean}
     * @private
     */
    encryptCommunication = true;

    /**
     * Flag for signaling if unsafe messages should be processed.
     *
     * @private
     * @type {boolean}
     */
    secure = true;

    constructor(options, redisOptions, logger) {
        super();
        this.logger = logger;
        this.logger.setThreadId(options.id);

        this.mainThread = parentPort;
        this.threadId = options.id;
        this.threadType = options.type;
        this.startupOptions = Object.assign(this.startupOptions, options.config);
        this.zxaibc = new ZxAIBC(this.startupOptions.zxaibc);

        this.encryptCommunication = this.startupOptions.zxaibc.encrypt || true;
        this.secure = this.startupOptions.zxaibc.secure || true;

        this.logger.log(
            `Starting new ${options.type} thread with ${this.startupOptions.stateManager} state manager...`,
        );

        if (this.startupOptions.stateManager === REDIS_STATE_MANAGER) {
            this.logger.log('... configuring Redis state manager');

            this.pubSubChannel = this.startupOptions.redis.pubSubChannel;
            this.cache = getRedisConnection(redisOptions);
            this.publishChannel = getRedisConnection(redisOptions);
            this.subscriptionChannel = getRedisConnection(redisOptions);
        }

        const formatters = this.formatters;

        if (options.formatters !== undefined &amp;&amp; typeof options.formatters === 'object') {
            Object.keys(options.formatters).forEach((formatterName) => {
                this.logger.log(`... loading custom formatters: ${formatterName}`);
                // Dynamic import of the formatter
                import(options.formatters[formatterName]).then(
                    (module) => {
                        if (Object.keys(module).includes('_in')) {
                            if (!formatters[formatterName]) {
                                formatters[formatterName] = {};
                            }
                            formatters[formatterName]['in'] = module['_in'];

                            this.logger.log(`... loaded ${formatterName}:_in`);
                        }

                        if (Object.keys(module).includes('_out')) {
                            if (!formatters[formatterName]) {
                                formatters[formatterName] = {};
                            }
                            formatters[formatterName]['out'] = module['_out'];

                            this.logger.log(`... loaded ${formatterName}:_out`);
                        }
                    },
                    (err) => {
                        this.logger.warn(`... error while importing ${formatterName}.`);
                        this.logger.debug('... stacktrace: ', err);
                    },
                );
            });
        }

        this.logger.log('... configuration complete.');
    }

    run(mqttClient) {
        this.mqttClient = mqttClient;
        this.mqttClient.on('connect', () => {
            this.logger.log('Successfully connected to MQTT.');
            markBootUpdate('mqtt.connection', true, this.threadId, this.threadType);
            this.mqttClient.subscribe(this.startupOptions.connection.topic, { qos: 2 },(err) => {
                if (!err) {
                    this.logger.log(`Successfully subscribed to ${this.startupOptions.connection.topic}.`);
                    markBootUpdate('mqtt.topic', true, this.threadId, this.threadType);

                    return;
                }

                this.logger.error(`Could not subscribe to ${this.startupOptions.connection.topic}.`);
                markBootUpdate('mqtt.topic', false, this.threadId, this.threadType);
            });
        });

        // TODO: onError => communications error => should gracefully stop thread
        this.mqttClient.on('error', this._onError);

        if (this.startupOptions.stateManager === REDIS_STATE_MANAGER) {
            markBootUpdate('redis.subscriptionChannel', !!this.subscriptionChannel, this.threadId, this.threadType);
            markBootUpdate('redis.publishChannel', !!this.publishChannel, this.threadId, this.threadType);
            markBootUpdate('redis.cache', !!this.cache, this.threadId, this.threadType);

            this.subscriptionChannel.subscribe(this.pubSubChannel, (err) => {
                if (err) {
                    this.logger.debug('Redis PubSub Stacktrace:', err);
                    markBootUpdate('redis.topic', false, this.threadId, this.threadType);
                } else {
                    markBootUpdate('redis.topic', true, this.threadId, this.threadType);
                }
            });

            this.subscriptionChannel.on('message', (channel, message) => {
                const parsed = JSON.parse(message);
                this.do(parsed.command, parsed);
            });
        } else {
            markBootUpdate('redis.subscriptionChannel', true, this.threadId, this.threadType);
            markBootUpdate('redis.publishChannel', true, this.threadId, this.threadType);
            markBootUpdate('redis.cache', true, this.threadId, this.threadType);
            markBootUpdate('redis.topic', true, this.threadId, this.threadType);
        }

        fromEvent(this.mqttClient, 'message')
            .pipe(
                map((message) => this._bufferToString(message)),
                filter((message) => {
                    return this._messageIsSigned(message);
                }),
                map((message) => this._toJSON(message)),
                filter((message) => this._messageIsFromEdgeNode(message)),
                tap((message) => this._processSupervisorPayload(message)),
                filter((message) => this._messageFromControlledFleet(message)),
                filter((message) => this._messageHasKnownFormat(message)),
                concatMap((message) => this._decodeToInternalFormat(message)),
            )
            .subscribe((message) => {
                const context = this._makeContext(message.EE_PAYLOAD_PATH);
                let data = message;

                // route heartbeats as they come
                if (this.threadType === THREAD_TYPE_HEARTBEATS) {
                    this.mainThread.postMessage({
                        threadId: this.threadId,
                        type: message.EE_EVENT_TYPE,
                        success: true,
                        error: null,
                        data: data,
                        context,
                    });

                    return;
                }

                // build the data and the context for this message
                data = { ...message.DATA };
                delete message.DATA;
                context.metadata = message;
                context.metadata['SESSION_ID'] = data['SESSION_ID'];

                // add notification metadata to context
                if (message.EE_EVENT_TYPE === MESSAGE_TYPE_NOTIFICATION) {
                    context.metadata['NOTIFICATION_CODE'] = data['NOTIFICATION_CODE'];
                    context.metadata['NOTIFICATION_TAG'] = data['NOTIFICATION_TAG'];
                    context.metadata['NOTIFICATION_TYPE'] = data['NOTIFICATION_TYPE'];
                }

                const sessionId = context.metadata.SESSION_ID;
                const path = context.metadata.EE_PAYLOAD_PATH.join(':');

                // for notifications, route responses to expecting inboxes for transaction handling
                // then bubble the notification for the consumer
                if (this.threadType === THREAD_TYPE_NOTIFICATIONS) {
                    // notification is relevant for another thread
                    if ((sessionId !== null &amp;&amp; !!this.watchlist[sessionId]) || !!this.watchlist[path]) {
                        if (this.startupOptions.stateManager === REDIS_STATE_MANAGER) {
                            const receivers = this.watchlist[sessionId]
                                ? [this.watchlist[sessionId]]
                                : this.watchlist[path];
                            receivers.forEach((receiver) => {
                                this.publishChannel.publish(
                                    receiver,
                                    JSON.stringify({
                                        type: MESSAGE_TYPE_NETWORK_REQUEST_RESPONSE,
                                        data: data,
                                        context,
                                    }),
                                );
                            });
                        } else {
                            this.mainThread.postMessage({
                                threadId: this.threadId,
                                type: MESSAGE_TYPE_NETWORK_REQUEST_RESPONSE,
                                success: true,
                                error: null,
                                data: data,
                                context,
                            });
                        }
                    }

                    this.mainThread.postMessage({
                        threadId: this.threadId,
                        type: message.EE_EVENT_TYPE,
                        success: true,
                        error: null,
                        data: data,
                        context,
                    });

                    return;
                }

                if (this.threadType === THREAD_TYPE_PAYLOADS) {
                    if (Object.hasOwn(data, 'COMMAND_PARAMS') &amp;&amp; !!data.COMMAND_PARAMS[STICKY_COMMAND_ID_KEY]) {
                        const stickyId = data.COMMAND_PARAMS[STICKY_COMMAND_ID_KEY];
                        const receiver = this.stickySessions[stickyId];

                            if (receiver &amp;&amp; this.startupOptions.stateManager === REDIS_STATE_MANAGER) {
                                this.publishChannel.publish(
                                    receiver,
                                    JSON.stringify({
                                        threadId: this.threadId,
                                        type: message.EE_EVENT_TYPE,
                                        success: true,
                                        error: null,
                                        data: data,
                                        context,
                                    }),
                                );

                            return;
                        }
                    }

                    this.mainThread.postMessage({
                        threadId: this.threadId,
                        type: message.EE_EVENT_TYPE,
                        success: true,
                        error: null,
                        data: data,
                        context,
                    });
                }
            });
    }

    do(command, message) {
        this.logger.debug(`Received command "${command}"`);

        switch (command) {
        case THREAD_COMMAND_UPDATE_FLEET:
            this._updateFleet(message);
            break;
        case THREAD_COMMAND_UPDATE_STATE:
            this._updateState(message);
            break;
        case THREAD_COMMAND_WATCH_FOR_SESSION_ID:
            this._watchForSessionId(message);
            break;
        case THREAD_COMMAND_IGNORE_SESSION_ID:
            this._ignoreSessionId(message);
            break;
        case THREAD_COMMAND_WATCH_FOR_STICKY_SESSION_ID:
            this._watchForStickySessionId(message);
            break;
        case THREAD_COMMAND_MEMORY_USAGE:
            this._reportMemoryUsage();
        }
    }

    /*************************************
     * Internal thread operations
     *************************************/

    _reportMemoryUsage() {
        this.mainThread.postMessage({
            threadId: this.threadId,
            type: MESSAGE_TYPE_THREAD_MEMORY_USAGE,
            success: true,
            error: null,
            // eslint-disable-next-line no-undef
            data: process.memoryUsage(),
        });
    }

    _updateState(data) {
        if (this.threadType === THREAD_TYPE_HEARTBEATS) {
            // heartbeats threads don't need the state
            return;
        }

        if (!this.state[data.node]) {
            this.state[data.node] = {};
        }

        this.state[data.node] = data.state;
    }

    _updateFleet(data) {
        this.startupOptions.fleet = data.fleet;
    }

    _watchForSessionId(data) {
        if (this.threadType !== THREAD_TYPE_NOTIFICATIONS) {
            return;
        }

        this.watchlist[data.requestId] = data.handler;
        data.watches.forEach((path) => {
            const key = path.join(':');
            if (!this.watchlist[key]) {
                this.watchlist[key] = [];
            }

            this.watchlist[key].push(data.handler);
        });
    }

    _removePathFromWatchlist(watchlist, path) {
        const index = watchlist.indexOf(path);
        if (index > -1) {
            return watchlist.filter((item) => item !== path);
        }

        return watchlist;
    }

    _ignoreSessionId(data) {
        if (this.threadType !== THREAD_TYPE_NOTIFICATIONS) {
            return;
        }

        if (this.watchlist[data.requestId]) {
            delete this.watchlist[data.requestId];
        }

        data.watches.forEach((path) => {
            const key = path.join(':');
            if (!this.watchlist[key]) {
                this.watchlist[key] = [];
            }

            this.watchlist[key] = this._removePathFromWatchlist(this.watchlist[key], data.handler);
            if (this.watchlist[key].length === 0) {
                delete this.watchlist[key];
            }
        });
    }

    _watchForStickySessionId(data) {
        if (this.threadType !== THREAD_TYPE_PAYLOADS) {
            return;
        }

        this.stickySessions[data.stickyId] = data.handler;
    }

    _makeContext(path) {
        const context = {
            pipeline: null,
            instance: null,
            metadata: null,
        };

        if (path[1] !== null) {
            // needs pipeline context
            const pipeline = this.state[path[0]] &amp;&amp; this.state[path[0]][path[1]] ? this.state[path[0]][path[1]] : null;
            if (pipeline) {
                context.pipeline = {
                    name: path[1],
                    type: pipeline.config.TYPE,
                    config: { ...pipeline.config },
                    stats: { ...pipeline.stats },
                    pluginsCount: Object.keys(pipeline.plugins)
                        .map((signature) => Object.keys(pipeline.plugins[signature]).length)
                        .reduce((r, v) => r + v, 0),
                };
            }
        }

        if (path[2] !== null &amp;&amp; path[3] !== null) {
            // needs instance context
            const signature = path[2];
            const instanceId = path[3];
            const instance =
                !!this.state[path[0]] &amp;&amp;
                !!this.state[path[0]][path[1]]?.plugins[signature] &amp;&amp;
                !!this.state[path[0]][path[1]]?.plugins[signature][instanceId]
                    ? this.state[path[0]][path[1]].plugins[signature][instanceId]
                    : null;

            let config = {};
            if (instance !== null &amp;&amp; instance?.config !== undefined) {
                config = { ...instance.config };
            }

            let stats = {};
            if (instance !== null &amp;&amp; instance?.stats !== undefined) {
                stats = { ...instance.stats };
            }

            context.instance = {
                name: instanceId,
                signature,
                config: config,
                stats: stats,
            };
        }

        return context;
    }

    _onError(err) {
        console.log(err);
    }

    /*************************************
     * Network messages funnel methods
     *************************************/

    _bufferToString(message) {
        let stringMessage = '{ EE_FORMATTER: \'ignore-this\'}';
        try {
            stringMessage = message[2].payload.toString('utf-8');
        } catch (e) {
            this.logger.debug('Message funnel _bufferToString error:', e);
        }

        return stringMessage;
    }

    _messageIsSigned(message) {
        let verify = this.zxaibc.verify(message);
        if (!verify &amp;&amp; this.startupOptions.zxaibc.debugMode) {
            this.logger.debug('Unverifiable message', message);
        }

        return !this.secure || verify;
    }

    _toJSON(message) {
        let parsedMessage;

        try {
            parsedMessage = JSON.parse(message);
            if (parsedMessage.EE_IS_ENCRYPTED !== undefined &amp;&amp; parsedMessage.EE_IS_ENCRYPTED === true) {
                const decrypted = this.zxaibc.decrypt(parsedMessage.EE_ENCRYPTED_DATA ?? null, parsedMessage.EE_SENDER);

                if (decrypted === null) {
                    return { EE_FORMATTER: 'ignore-this' };
                }

                this.logger.debug(`Decrypted message from ${parsedMessage.EE_SENDER}...`);

                const content = JSON.parse(decrypted);
                Object.keys(content).forEach((key) => {
                    parsedMessage[key] = content[key];
                });
            }
        } catch (e) {
            return { EE_FORMATTER: 'ignore-this' };
        }

        return parsedMessage;
    }

    _messageIsFromEdgeNode(message) {
        return !!message.EE_PAYLOAD_PATH;
    }

    _processSupervisorPayload(message) {
        if (
            this.threadType === THREAD_TYPE_PAYLOADS &amp;&amp;
            message.EE_PAYLOAD_PATH[1]?.toLowerCase() === 'admin_pipeline'
        ) {
            const duplicate = { ...message };
            if (this._messageHasKnownFormat(duplicate)) {
                this._decodeToInternalFormat(duplicate).then((decoded) => {
                    if (decoded.EE_PAYLOAD_PATH[2]?.toLowerCase() === 'net_mon_01') {

                        if (decoded.DATA?.CURRENT_NETWORK !== undefined) {
                            this.mainThread.postMessage({
                                threadId: this.threadId,
                                type: MESSAGE_TYPE_SUPERVISOR_STATUS,
                                success: true,
                                error: null,
                                data: decoded.DATA,
                            });

                            const addresses = {};
                            Object.keys(decoded.DATA.CURRENT_NETWORK ?? {}).forEach((nodeName) => {
                                addresses[nodeName] = decoded.DATA.CURRENT_NETWORK[nodeName].address;
                            });

                            this.mainThread.postMessage({
                                threadId: this.threadId,
                                type: MESSAGE_TYPE_NETWORK_ADDRESSES_REFRESH,
                                success: true,
                                error: null,
                                data: addresses,
                            });
                        }

                        if (decoded.DATA.IS_ALERT === true &amp;&amp; !!decoded.DATA?.CURRENT_ALERTED) {
                            const alerted = Object.keys(decoded.DATA.CURRENT_ALERTED).map((nodeName) => ({
                                node: nodeName,
                                lastSeen: decoded.DATA.CURRENT_ALERTED[nodeName]['last_seen_sec'],
                            }));

                            this.mainThread.postMessage({
                                threadId: this.threadId,
                                type: MESSAGE_TYPE_NETWORK_NODE_DOWN,
                                success: true,
                                error: null,
                                data: alerted,
                            });
                        }
                    }

                    const context = {
                        metadata: {},
                        pipeline: {},
                        instance: {},
                    };
                    const data = { ...decoded.DATA };
                    delete decoded.DATA;
                    context.metadata = decoded;
                    context.metadata['SESSION_ID'] = data['SESSION_ID'];
                    context.pipeline = {
                        name: context.metadata.EE_PAYLOAD_PATH[1],
                    };
                    context.instance = {
                        name: context.metadata.EE_PAYLOAD_PATH[3],
                    };

                    this.mainThread.postMessage({
                        threadId: this.threadId,
                        type: MESSAGE_TYPE_NETWORK_SUPERVISOR_PAYLOAD,
                        success: true,
                        error: null,
                        data: data,
                        context: context,
                    });
                });
            }
        }
    }

    _messageFromControlledFleet(message) {
        const node = message.EE_PAYLOAD_PATH[0];

        if (this.threadType === THREAD_TYPE_HEARTBEATS) {
            this.mainThread.postMessage({
                threadId: this.threadId,
                type: MESSAGE_TYPE_OBSERVED_NODE,
                success: true,
                error: null,
                data: {
                    node: node,
                    timestamp: new Date().getTime(),
                },
            });
        }

        return !hasFleetFilter(this.startupOptions.fleet) || this.startupOptions.fleet.includes(node);
    }

    _messageHasKnownFormat(message) {
        let knownFormat =
            message.EE_FORMATTER === '' ||
            !message.EE_FORMATTER ||
            !!this.formatters[message.EE_FORMATTER.toLowerCase()];

        if (!knownFormat) {
            this.logger.warn(`Unknown format ${message.EE_FORMATTER}. Message dropped.`);
        }

        return knownFormat;
    }

    async _decodeToInternalFormat(message) {
        const format = message.EE_FORMATTER ?? 'raw';
        const internalMessage = this.formatters[format].in(message);

        switch (internalMessage.EE_EVENT_TYPE) {
            case MESSAGE_TYPE_HEARTBEAT:
                internalMessage.DATA = await processHeartbeat(internalMessage.DATA);
                break;
            case MESSAGE_TYPE_NOTIFICATION:
                internalMessage.DATA = notificationProcessor(internalMessage.DATA);
                break;
            case MESSAGE_TYPE_PAYLOAD:
                internalMessage.DATA = payloadProcessor(internalMessage.DATA);
                break;
        }

        return internalMessage;
    }
}

let thread = null;
parentPort?.on('message', (message) => {
    logger.verbose('Thread received message: ', message);

    if (message.command === THREAD_COMMAND_START) {
        const startupOptions = message.config;

        let redisOptions = null;
        if (startupOptions.stateManager === REDIS_STATE_MANAGER) {
            redisOptions = startupOptions.redis;
        }

        thread = new Thread(message, redisOptions, logger);

        const mqttOptions = {
            username: startupOptions.connection.username,
            password: startupOptions.connection.password,
            clean: startupOptions.connection.clean !== false,
            clientId: (startupOptions.connection.clientId !== undefined &amp;&amp; startupOptions.connection.clientId !== null)
                ? `${startupOptions.connection.prefix}_${startupOptions.connection.clientId}_${startupOptions.connection.suffix}`
                : null,
        };

        const mqttClient = mqtt.connect(startupOptions.connection.url, mqttOptions);

        logger.log(`Configured MQTT connection at "${startupOptions.connection.url}" with (clean=${JSON.stringify(mqttOptions.clean)};clientId=${mqttOptions.clientId})`);

        thread.run(mqttClient);
    }

    if (message.command === THREAD_COMMAND_UPDATE_STATE) {
        thread.do(THREAD_COMMAND_UPDATE_STATE, message);
    }

    if (message.command === THREAD_COMMAND_UPDATE_FLEET) {
        thread.do(THREAD_COMMAND_UPDATE_FLEET, message);
    }

    if (message.command === THREAD_COMMAND_WATCH_FOR_SESSION_ID) {
        thread.do(THREAD_COMMAND_WATCH_FOR_SESSION_ID, message);
    }

    if (message.command === THREAD_COMMAND_IGNORE_SESSION_ID) {
        thread.do(THREAD_COMMAND_IGNORE_SESSION_ID, message);
    }

    if (message.command === THREAD_COMMAND_MEMORY_USAGE) {
        thread.do(THREAD_COMMAND_MEMORY_USAGE);
    }
});
</code></pre></article></section></div></div></div><div class="search-container" id="PkfLWpAbet" style="display:none"><div class="wrapper" id="iCxFxjkHbP"><button class="icon-button search-close-button" id="VjLlGakifb" aria-label="close search"><svg><use xlink:href="#close-icon"></use></svg></button><div class="search-box-c"><svg><use xlink:href="#search-icon"></use></svg> <input type="text" id="vpcKVYIppa" class="search-input" placeholder="Search..." autofocus></div><div class="search-result-c" id="fWwVHRuDuN"><span class="search-result-c-text">Type anything to view search result</span></div></div></div><div class="mobile-menu-icon-container"><button class="icon-button" id="mobile-menu" data-isopen="false" aria-label="menu"><svg><use xlink:href="#menu-icon"></use></svg></button></div><div id="mobile-sidebar" class="mobile-sidebar-container"><div class="mobile-sidebar-wrapper"><a href="/" class="sidebar-title sidebar-title-anchor">Home</a><div class="mobile-nav-links"></div><div class="mobile-sidebar-items-c"><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-classes"><div>Classes</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="DataCaptureThread.html">DataCaptureThread</a></div><div class="sidebar-section-children"><a href="InternalStateManager.html">InternalStateManager</a></div><div class="sidebar-section-children"><a href="Logger.html">Logger</a></div><div class="sidebar-section-children"><a href="NetworkRequest.html">NetworkRequest</a></div><div class="sidebar-section-children"><a href="NetworkRequestsHandler.html">NetworkRequestsHandler</a></div><div class="sidebar-section-children"><a href="NodeManager.html">NodeManager</a></div><div class="sidebar-section-children"><a href="Pipeline.html">Pipeline</a></div><div class="sidebar-section-children"><a href="PluginInstance.html">PluginInstance</a></div><div class="sidebar-section-children"><a href="RedisStateManager.html">RedisStateManager</a></div><div class="sidebar-section-children"><a href="State.html">State</a></div><div class="sidebar-section-children"><a href="ZxAIBC.html">ZxAIBC</a></div><div class="sidebar-section-children"><a href="ZxAIClient.html">ZxAIClient</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-global"><div>Global</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="global.html#AlertedNodes">AlertedNodes</a></div><div class="sidebar-section-children"><a href="global.html#AllowedValues">AllowedValues</a></div><div class="sidebar-section-children"><a href="global.html#AvailableDCTResponse">AvailableDCTResponse</a></div><div class="sidebar-section-children"><a href="global.html#AvailableSchemaResponse">AvailableSchemaResponse</a></div><div class="sidebar-section-children"><a href="global.html#Field">Field</a></div><div class="sidebar-section-children"><a href="global.html#IntervalDefinition">IntervalDefinition</a></div><div class="sidebar-section-children"><a href="global.html#IsObject">IsObject</a></div><div class="sidebar-section-children"><a href="global.html#NodeStatus">NodeStatus</a></div><div class="sidebar-section-children"><a href="global.html#ObservedNodes">ObservedNodes</a></div><div class="sidebar-section-children"><a href="global.html#RedisConnectionOptions">RedisConnectionOptions</a></div><div class="sidebar-section-children"><a href="global.html#SchemaCollection">SchemaCollection</a></div><div class="sidebar-section-children"><a href="global.html#SchemaDefinition">SchemaDefinition</a></div><div class="sidebar-section-children"><a href="global.html#SchemasRepository">SchemasRepository</a></div><div class="sidebar-section-children"><a href="global.html#ZxAIBlockchainOptions">ZxAIBlockchainOptions</a></div><div class="sidebar-section-children"><a href="global.html#ZxAIClientEvent">ZxAIClientEvent</a></div><div class="sidebar-section-children"><a href="global.html#ZxAIClientOptions">ZxAIClientOptions</a></div><div class="sidebar-section-children"><a href="global.html#ZxAICommand">ZxAICommand</a></div><div class="sidebar-section-children"><a href="global.html#ZxAIEventType">ZxAIEventType</a></div><div class="sidebar-section-children"><a href="global.html#ZxAIUpdateInstanceConfig">ZxAIUpdateInstanceConfig</a></div><div class="sidebar-section-children"><a href="global.html#applyDefaultsToObject">applyDefaultsToObject</a></div><div class="sidebar-section-children"><a href="global.html#archiveConfigRequestStrategy">archiveConfigRequestStrategy</a></div><div class="sidebar-section-children"><a href="global.html#base64ToUrlSafeBase64">base64ToUrlSafeBase64</a></div><div class="sidebar-section-children"><a href="global.html#camelToZxAIFormat">camelToZxAIFormat</a></div><div class="sidebar-section-children"><a href="global.html#checkMandatoryFields">checkMandatoryFields</a></div><div class="sidebar-section-children"><a href="global.html#checkType">checkType</a></div><div class="sidebar-section-children"><a href="global.html#computeDifferences">computeDifferences</a></div><div class="sidebar-section-children"><a href="global.html#convertKeysToCamelFormat">convertKeysToCamelFormat</a></div><div class="sidebar-section-children"><a href="global.html#convertKeysToZxAIFormat">convertKeysToZxAIFormat</a></div><div class="sidebar-section-children"><a href="global.html#dctSchemas">dctSchemas</a></div><div class="sidebar-section-children"><a href="global.html#decode">decode</a></div><div class="sidebar-section-children"><a href="global.html#defaultSchemas">defaultSchemas</a></div><div class="sidebar-section-children"><a href="global.html#encode">encode</a></div><div class="sidebar-section-children"><a href="global.html#generateId">generateId</a></div><div class="sidebar-section-children"><a href="global.html#getRedisConnection">getRedisConnection</a></div><div class="sidebar-section-children"><a href="global.html#hasFleetFilter">hasFleetFilter</a></div><div class="sidebar-section-children"><a href="global.html#identityFormatter">identityFormatter</a></div><div class="sidebar-section-children"><a href="global.html#pick">pick</a></div><div class="sidebar-section-children"><a href="global.html#pluginDefinition">pluginDefinition</a></div><div class="sidebar-section-children"><a href="global.html#pluginSchemas">pluginSchemas</a></div><div class="sidebar-section-children"><a href="global.html#rawIn">rawIn</a></div><div class="sidebar-section-children"><a href="global.html#schema">schema</a></div><div class="sidebar-section-children"><a href="global.html#schema">schema</a></div><div class="sidebar-section-children"><a href="global.html#schema">schema</a></div><div class="sidebar-section-children"><a href="global.html#schema">schema</a></div><div class="sidebar-section-children"><a href="global.html#schema">schema</a></div><div class="sidebar-section-children"><a href="global.html#schema">schema</a></div><div class="sidebar-section-children"><a href="global.html#schemas">schemas</a></div><div class="sidebar-section-children"><a href="global.html#sleep">sleep</a></div><div class="sidebar-section-children"><a href="global.html#updateConfigRequestStrategy">updateConfigRequestStrategy</a></div><div class="sidebar-section-children"><a href="global.html#updatePipelineInstanceRequestStrategy">updatePipelineInstanceRequestStrategy</a></div><div class="sidebar-section-children"><a href="global.html#urlSafeBase64ToBase64">urlSafeBase64ToBase64</a></div><div class="sidebar-section-children"><a href="global.html#validateAgainstSchema">validateAgainstSchema</a></div><div class="sidebar-section-children"><a href="global.html#zxAIFormatToCamel">zxAIFormatToCamel</a></div></div></div><div class="mobile-navbar-actions"><div class="navbar-right-item"><button class="icon-button search-button" aria-label="open-search"><svg><use xlink:href="#search-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button theme-toggle" aria-label="toggle-theme"><svg><use class="theme-svg-use" xlink:href="#light-theme-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button font-size" aria-label="change-font-size"><svg><use xlink:href="#font-size-icon"></use></svg></button></div></div></div></div><script type="text/javascript" src="scripts/core.min.js"></script><script src="scripts/search.min.js" defer="defer"></script><script src="scripts/third-party/fuse.js" defer="defer"></script><script type="text/javascript">var tocbotInstance=tocbot.init({tocSelector:"#eed4d2a0bfd64539bb9df78095dec881",contentSelector:".main-content",headingSelector:"h1, h2, h3",hasInnerContainers:!0,scrollContainer:".main-content",headingsOffset:130,onClick:bringLinkToView})</script></body></html>